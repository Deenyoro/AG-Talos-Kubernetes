---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - pvc.yaml
  - secret.sops.yaml
  - helmrelease.yaml
generatorOptions:
  disableNameSuffixHash: true

configMapGenerator:
  - name: meshcentral-vars
    literals:
      - TIMEZONE=America/New_York
      - SECRET_DOMAIN=kawalink.com
      - HOSTNAME=meshcentral.${SECRET_DOMAIN}
      - PORT=443
      - TLS_OFFLOAD=true
      - NEW_ACCOUNTS=false
      - WEBRTC=true

vars:
  - name: TIMEZONE
    objref:
      kind: ConfigMap
      name: meshcentral-vars
      apiVersion: v1
    fieldref:
      fieldpath: data.TIMEZONE
  - name: SECRET_DOMAIN
    objref:
      kind: ConfigMap
      name: meshcentral-vars
      apiVersion: v1
    fieldref:
      fieldpath: data.SECRET_DOMAIN
  - name: HOSTNAME
    objref:
      kind: ConfigMap
      name: meshcentral-vars
      apiVersion: v1
    fieldref:
      fieldpath: data.HOSTNAME
  - name: PORT
    objref:
      kind: ConfigMap
      name: meshcentral-vars
      apiVersion: v1
    fieldref:
      fieldpath: data.PORT
  - name: TLS_OFFLOAD
    objref:
      kind: ConfigMap
      name: meshcentral-vars
      apiVersion: v1
    fieldref:
      fieldpath: data.TLS_OFFLOAD
  - name: NEW_ACCOUNTS
    objref:
      kind: ConfigMap
      name: meshcentral-vars
      apiVersion: v1
    fieldref:
      fieldpath: data.NEW_ACCOUNTS
  - name: WEBRTC
    objref:
      kind: ConfigMap
      name: meshcentral-vars
      apiVersion: v1
    fieldref:
      fieldpath: data.WEBRTC
